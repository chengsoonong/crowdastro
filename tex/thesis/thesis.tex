%!TeX program=xelatex
%%
%% Template thesis.tex
%%
\documentclass[11pt]{book}
\usepackage[palatino]{anuthesis}
\usepackage{graphicx}
\usepackage{thesis}
\usepackage{makeidx}
\usepackage{acmnew-xref}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}

% hyperref setup taken from Aladair Tran's thesis:
% github.com/chengsoonong/mclass-sky
\hypersetup{
    bookmarksnumbered,
    colorlinks   = true,
    urlcolor     = {blue!80!black},
    linkcolor    = {red!50!black},
    citecolor    = {blue!50!black},
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Preamble
\title{Thesis Title Here}
\author{Matthew Alger}
\date{\today}

\renewcommand{\thepage}{\roman{page}}

\makeindex
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Title page
\pagestyle{empty}
\thispagestyle{empty}
\input titlepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Here begin the preliminaries
\input frontmatter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Dedication (optional)
\cleardoublepage
\pagestyle{empty}
\input dedication

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Acknowledgements (optional!)
\cleardoublepage
\pagestyle{empty}
\input ack

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Abstract
\cleardoublepage
\pagestyle{headings}
\input abstract

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Table of contents
\cleardoublepage
\pagestyle{headings}
\markboth{Contents}{Contents}
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Here begins the main text
\mainmatter

%% Introduction
% \input intro

%% Chapters
% I'll chapterise this later.
% \input{1_radio_sky}
% \input{2_ml}

\chapter{Chapter Name Here}

\section{Cross-identification}
\label{sec:cross-identification}

    Each radio object has some associated infrared object called the host galaxy. The cross-identification task is to find the host galaxy given the radio object.
    
    This can be formalised as follows. Consider a set $\mathcal X$ of candidate host galaxies, and a radio object $r$ that we want to assign a host galaxy. Let $y : \mathcal X \to \{0, 1\}$ represent whether a given $x \in \mathcal X$ is the host galaxy associated with $r$. If we assume that a radio object has exactly one associated host galaxy, then there exists exactly one $x \in \mathcal X$ such that $y(x) = 1$, and for all other $x \in \mathcal X$, $y(x) = 0$. The cross-identification task then amounts to modelling $p(y(x) = 1 \mid x, r)$. Once this distribution is modelled, the host galaxy associated with $r$ is given by
    \begin{equation}
        \label{eq:cross-identification}
        \mbox{host}(r) = \underset{x}{\mbox{argmax}}\ p(y(x) = 1 \mid x, r).
    \end{equation}

    Ideally, $\mathcal X$ is the set of all galaxies. This is clearly intractable and unknowable, so as an approximation we use a catalogue of infrared objects near the radio object of interest, taken from a survey such as SWIRE or WISE. We also make the assumption that the host galaxy is within $1'$ of the radio object --- while this doesn't hold in general, systems larger than $1'$ are rare and require human insight to discover\cite{banfield16}.

    For modelling the distribution, I have chosen to use logistic regression, i.e.
    \begin{equation}
        \label{eq:logistic-regression-cross-identification}
        p(y(x) = 1 \mid x, r) = \vec w \cdot \vec \phi(x, r)
    \end{equation}
    where $\vec \phi$ is a feature space mapping dependent on a galaxy and a radio object. The features should represent the galaxy in some way, so I have chosen the following feature space:
    \begin{equation}
        \label{eq:galaxy-features}
        \vec \phi(x, r) = \begin{pmatrix}
            \vec{\mbox{flux}}(x)\\
            \mbox{dist}(x, r)\\
            \vec{\mbox{cnn}}(\mbox{radio}(x))
        \end{pmatrix}
    \end{equation}
    $\vec{\mbox{flux}}(x)$ is a vector of infrared flux measurements of $x$, which can be obtained from the infrared survey catalogue. $\mbox{dist}(x, r)$ is the Euclidean distance across the sky between the centre of the $x$ and the centre of $r$. $\vec{\mbox{cnn}}(m)$ is the output of the convolutional neural network on input image $m$, and $\mbox{radio}(x)$ is a $0.8' \times 0.8'$ image of the radio sky centred on $x$.

%% Conclusion
\input conclusion

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Here begins the end matter

\input appendix

\backmatter

\bibliographystyle{acmnew-xref}
\bibliography{../papers}

\printindex

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "thesis"
%%% End: 



