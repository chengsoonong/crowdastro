%!TeX program=xelatex
\documentclass[a4paper]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[margin=1in]{geometry}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{algorithm2e}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={green!50!black}
}
\usepackage{subcaption}
\usepackage[numbers]{natbib}
\usepackage[usenames,dvipsnames]{pstricks}
\usepackage{epsfig}

\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{Palatino Linotype}

\newcommand{\fig}{Figure }
\newcommand{\sect}{Section }

\begin{document}
  {\Large\noindent  Machine Learning on the Radio Galaxy Zoo}\\

  {\large\noindent  Matthew Alger \hfill Supervisor: Cheng Soon Ong}\\

  {\large\noindent  June 3, 2016}\\

  \begin{abstract}
    I did something and it kinda worked
  \end{abstract}

  \section{Introduction}

    \subsection{Cross-identification of Radio Sources and Host Galaxies}

      Radio surveys such as Faint Images of the Radio Sky at Twenty-Centimeters (FIRST) \cite{white97,becker95} and the Australian Telescope Large Area Survey (ATLAS) \cite{franzen15} have found many sources of radio emissions. These radio sources are dominated by \emph{active galactic nuclei} (AGNs) \cite{banfield15}, galactic centres with supermassive black holes that emit radio\cite{peterson97}. Galaxies containing a radio source are referred to as \emph{host galaxies}. These galaxies are found in infrared surveys such as the Wide-field Infrared Survey Explorer (WISE) \cite{wright10} and the SIRTF Wide-area Infrared Extragalactic survey (SWIRE) \cite{surace05,lonsdale03}.

      Astrophysicists are interested in the properties of both AGNs and their host galaxies, but to investigate either, the radio sources need to be matched to their host galaxies. This is called \emph{cross-identification}. Many radio sources are \emph{compact radio sources}, where the radio emissions directly and simply overlap the host galaxy (\fig \ref{fig:compact-source}). These radio sources are easy to cross-identify\cite{banfield15}. However, many radio sources are instead \emph{complex radio sources}, where radio emissions can be large, sprawling, and not relate to the host galaxy in any simple way (\fig \ref{fig:complex-source}).

      \begin{figure}[!ht]
        \centering
          \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{images/ARG0003r22_radio.png}
            \caption{A compact radio source.}
            \label{fig:compact-source}
          \end{subfigure}
          \quad
          \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth]{images/ARG0002dun_radio.jpg}
            \caption{A complex radio source.}
            \label{fig:complex-source}
          \end{subfigure}
          \caption{Example radio emissions.}
      \end{figure}

      \emph{Radio Galaxy Zoo}\footnote{\href{http://radio.galaxyzoo.org/}{Radio Galaxy Zoo}} is an online citizen science project that aims to crowdsource the cross-identification problem\cite{banfield15}. Volunteers are presented with a radio image of a small part of the sky (from FIRST or ATLAS) and the corresponding infrared image (from WISE or SWIRE). Each part of the sky presented in this way is called a \emph{subject}, and contains at least one radio emitter. Volunteers are asked to select which radio emissions are part of the same system, and which galaxy in the infrared image contains the corresponding AGN. The workflow is shown in \fig \ref{fig:rgz}.

      \begin{figure}[!ht]
        \centering
          \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth, height=2.3in]{images/rgz_radio.png}
            \caption{Select radio emissions.}
          \end{subfigure}
          \quad
          \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth, height=2.3in]{images/rgz_ir.png}
            \caption{Locate the AGN.}
          \end{subfigure}
          \quad
          \begin{subfigure}{0.3\textwidth}
            \includegraphics[width=\linewidth, height=2.3in]{images/rgz_done.png}
            \caption{Repeat for all emissions.}
          \end{subfigure}
          \caption{Radio Galaxy Zoo volunteer workflow.}
          \label{fig:rgz}
      \end{figure}

      To increase cross-identification accuracy, each compact radio source is presented to $5$ volunteers, and each complex radio source is presented to $20$ volunteers\cite{banfield15}.

      Over 100000 radio sources have been cross-identified by volunteers so far\footnote{Based on the data supplied to the author.} out of the Radio Galaxy Zoo database of around 177000 radio sources, compared to a few thousand classifications by experts\cite{banfield15}. However, new surveys such as the Evolutionary Map of the Universe (EMU) \cite{norris11} and Westerbork Observations of the Deep APERTIF Northern-Sky (WODAN) \cite{röttgering11} are expected to detect over 100 million radio sources\cite{banfield15}, making crowdsourcing an intractable solution to the cross-identification problem.

      In this report, I describe my research into using cross-identifications made by Radio Galaxy Zoo volunteers as a training set for training supervised machine learning algorithms to automatically perform the cross-identification task.

    \subsection{Related Work}

      Proctor 2006\cite{proctor06}; Kimball \& Ivezić 2008; van Velzen, Falcke, \& Körding 2015; Fan et al. 2015\cite{fan15}

  \section{Data Sources}

    \subsection{ATLAS}

      ATLAS is a radio-wavelength survey of the Chandra Deep Field South (CDFS) and the European Large Area ISO Survey -- South 1 (ELAIS-S1) fields, chosen as they are areas of the sky covered by the earlier SWIRE survey. This means that the ATLAS observations have corresponding observations in infrared wavelengths\cite{franzen15}, which are necessary for cross-identification as the distant galaxies of interest emit infrared radiation.

      While the Radio Galaxy Zoo data include classifications of objects in both the ATLAS and FIRST surveys, here I have only focused on the ATLAS observations of CDFS. Reasons\cite{franzen15}:
      \begin{itemize}
        \item ATLAS is small and nice
        \item We have complete expert classifications of ATLAS
        \item ATLAS is mostly well-behaved, compact objects
        \item ATLAS is considered a test run for EMU
      \end{itemize}

      ATLAS observations of CDFS consist of a $3.6 \text{ deg}^2$ mosaic of radio images between $3^\text{h}26^\text{m}-27^\circ 00'$ and $3^\text{h}36^\text{m}-29^\circ 00'$. The full ATLAS image of the CDFS field is shown in \fig \ref{fig:cdfs}.

      \begin{figure}[!ht]
        \centering
        \includegraphics[width=0.8\linewidth,]{images/ATLAS-CDFS-cropped.pdf}
        \caption{ATLAS observations of CDFS. Reproduced from \citet{franzen15}.}.
        \label{fig:cdfs}
      \end{figure}

      Each ATLAS object forms a subject. Each subject consists of a $2' \times 2'$ image patch from \fig \ref{fig:cdfs} and a corresponding image patch from SWIRE centred on the associated ATLAS object.

    \subsection{SWIRE}

      SWIRE is an infrared-wavelength survey of seven regions of the sky in seven infrared bands. Of these regions, CDFS and ELAIS-S1 overlap with ATLAS and are hence used in Radio Galaxy Zoo.

      SWIRE observations are infrared images in the various fields, and are provided in Radio Galaxy Zoo as $2' \times 2'$ image patches centred on ATLAS subjects. In addition, I make use of the SWIRE CDFS Region Fall '05 Spitzer Catalog\cite{surace05}, which describes all objects detected in the CDFS field in the SWIRE survey.

      For each object in CDFS, the catalogue provides the name, location, infrared fluxes, and stellarity index associated with that object. The location is specified in right ascension and declination. The fluxes are given in five bands ($3.6\ \mu$Jy, $4.5\ \mu$Jy, $5.8\ \mu$Jy, $8.0\ \mu$Jy, and $24\ \mu$Jy) and describe how bright each object is in the corresponding flux band. Finally, the stellarity index is an indicator of how star-like each object is according to the SExtractor software package, where $0$ denotes an object that is totally non-star-like, and $1$ denotes an object that is totally star-like\cite{surace05}.

    \subsection{Radio Galaxy Zoo}

      Each ATLAS subject in the Radio Galaxy Zoo data is associated with a set of \emph{crowd classifications}, cross-identifications performed by volunteers. Each classification describes which radio objects near the subject the volunteer believes are part of the same radio source (called a \emph{radio combination}), as well as the location that the volunteer believes the corresponding host galaxy is located at.

      There are multiple classifications for each subject ($5$ for compact sources and $20$ for complex sources) to attempt to improve accuracy. These classifications differ from each other, so they need to be brought together in some way to identify a single radio combination/galaxy location label for each radio source in the data. The collated radio combinations for subjects are called \emph{radio consensuses}, the collated locations for a subject are called \emph{location consensuses}, and collated classifications on the whole are called \emph{consensuses}. Ideally, we want to take some ``majority vote'' and choose the most common radio combination as the radio consensus and then the most common corresponding locations as the location consensuses. The former is simple --- we just count the different combinations of radio objects and choose the most common --- but finding the location consensus is considerably more difficult as many different locations could represent the same host galaxy. \citet{banfield15} solve this problem by performing kernel density estimation on the locations associated with each radio combination, then choosing the location with the highest density. I have experimented with a different method that uses PG-means\cite{hamerly07}, described later in \sect \ref{sec:consensuses}.


  \section{The Cross-identification Task}

    \subsection{Cross-identification as Binary Classification}

      The first step in applying machine learning methods to the cross-identification task is to find a machine learning framework that it fits in. The cross-identification task can be modelled as binary classification, allowing the use of standard binary classification methods. This is done as follows. For an ATLAS subject, consider all SWIRE objects within $1'$ Chebyshev distance of the corresponding ATLAS object's location, i.e., all galaxies that a volunteer would be allowed to choose from in the crowdsourced cross-identification task. Each SWIRE object is then either the host galaxy or not the host galaxy. ``Host galaxy'' and ``not host galaxy'' can then be interpreted as two distinct classes, forming a binary classification problem. After training a classifier on this task, we can find the host galaxy in a subject by using the classifier to predict the probabilities that each object is the host galaxy, and then simply choose the object with the highest probability of being the host galaxy. Note that I am ignoring the problem of having multiple host galaxies in a subject, and am assuming that any subject contains exactly one host. This is an oversimplification as there are indeed subjects that contain multiple hosts, but there are very few in the ATLAS data and they greatly increase the difficulty of the problem.

    \subsection{Feature-space Representation of SWIRE Objects}

      To be able to classify each SWIRE object, we need to find some feature-space representation of the object. I have chosen to use a combination of the fluxes obtained from the SWIRE catalogue and features extracted from $0.8' \times 0.8'$ radio images centred on each SWIRE object. The infrared images around each object seem to contain little predictive information, and so are not included in the features.

      All five fluxes are included directly as features to the classifier. To obtain the radio features, $0.8' \times 0.8'$ patches of the ATLAS radio images are taken from around each SWIRE object. These images are passed through a convolutional neural network to obtain 32 features. The network architecture is shown in \fig \ref{fig:cnn}. This network was trained by appending a $32 \times 64$ dense layer and a $64 \times 1$ dense layer, then tasking the convolutional neural network with solving the entire binary classification problem in the hope that useful features would be found by the convolutional filters.

      \begin{figure}
        \centering
        \input{cnn}
        \caption{Convolutional neural network for radio feature extraction. An $80 \times 80$ pixel patch of radio image (corresponding to $0.8' \times 0.8'$ of radio sky) is passed through two convolutional layers to obtain 32 features.}
        \label{fig:cnn}
      \end{figure}

  \section{Classification Pipeline}

    As input, we consider an ATLAS subject. We wish to automatically identify where the host galaxy that emitted this radio source is located.



  \section{Collating Classifications}
  \label{sec:consensuses}

    talk about pg means

  \section{Results}

    show logistic regression and random forest precision/recall plots and confusion matrices

    show classification accuracies on the full problem, with and without different feature sets

    show some examples of colour-coded subjects

  \section{Discussion}

  \section{Conclusion}

  \bibliographystyle{abbrvnat}
  \bibliography{../papers}

\end{document}